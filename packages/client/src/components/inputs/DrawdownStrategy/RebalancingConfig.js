import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useAppStore } from '../../../store/useAppStore';
import { AssetClass } from '@shared/index';
import { NumericInput } from '../../shared/NumericInput';
import { ToggleSwitch } from '../../shared/ToggleSwitch';
import { GlidePathEditor } from './GlidePathEditor';
export const RebalancingConfig = () => {
    const { drawdownStrategy, updateRebalancingAllocation, setGlidePathEnabled } = useAppStore();
    const { rebalancing } = drawdownStrategy;
    const { targetAllocation, glidePathEnabled } = rebalancing;
    const total = (targetAllocation[AssetClass.STOCKS] + targetAllocation[AssetClass.BONDS] + targetAllocation[AssetClass.CASH]);
    const isValid = Math.abs(total - 1) < 0.001;
    return (_jsxs("div", { className: "flex flex-col gap-6", children: [_jsxs("div", { className: "flex flex-col gap-4", children: [_jsx("span", { className: "text-[11px] font-medium text-slate-500 uppercase tracking-wider", children: "Target Allocation" }), _jsxs("div", { className: "grid grid-cols-1 gap-3", children: [_jsxs("div", { className: "flex items-center justify-between gap-4", children: [_jsxs("div", { className: "flex items-center gap-2", children: [_jsx("div", { className: "w-2 h-2 rounded-full bg-[#4A90D9]" }), _jsx("span", { className: "text-[13px] font-medium text-slate-600", children: "Stocks" })] }), _jsx(NumericInput, { value: targetAllocation[AssetClass.STOCKS], onChange: (val) => updateRebalancingAllocation({ ...targetAllocation, [AssetClass.STOCKS]: val }), format: "percent", suffix: "%", disabled: glidePathEnabled, className: "w-20" })] }), _jsxs("div", { className: "flex items-center justify-between gap-4", children: [_jsxs("div", { className: "flex items-center gap-2", children: [_jsx("div", { className: "w-2 h-2 rounded-full bg-[#2EAD8E]" }), _jsx("span", { className: "text-[13px] font-medium text-slate-600", children: "Bonds" })] }), _jsx(NumericInput, { value: targetAllocation[AssetClass.BONDS], onChange: (val) => updateRebalancingAllocation({ ...targetAllocation, [AssetClass.BONDS]: val }), format: "percent", suffix: "%", disabled: glidePathEnabled, className: "w-20" })] }), _jsxs("div", { className: "flex items-center justify-between gap-4", children: [_jsxs("div", { className: "flex items-center gap-2", children: [_jsx("div", { className: "w-2 h-2 rounded-full bg-[#D4A843]" }), _jsx("span", { className: "text-[13px] font-medium text-slate-600", children: "Cash" })] }), _jsx(NumericInput, { value: targetAllocation[AssetClass.CASH], onChange: (val) => updateRebalancingAllocation({ ...targetAllocation, [AssetClass.CASH]: val }), format: "percent", suffix: "%", disabled: glidePathEnabled, className: "w-20" })] })] }), _jsxs("div", { className: "flex flex-col gap-1.5", children: [_jsxs("div", { className: "w-full h-2 rounded-full overflow-hidden flex bg-slate-100", children: [_jsx("div", { style: { width: `${targetAllocation[AssetClass.STOCKS] * 100}%`, backgroundColor: '#4A90D9' } }), _jsx("div", { style: { width: `${targetAllocation[AssetClass.BONDS] * 100}%`, backgroundColor: '#2EAD8E' } }), _jsx("div", { style: { width: `${targetAllocation[AssetClass.CASH] * 100}%`, backgroundColor: '#D4A843' } })] }), _jsx("div", { className: "flex justify-between items-center", children: _jsxs("span", { className: `text-[10px] font-bold ${isValid ? 'text-emerald-600' : 'text-rose-600'}`, children: ["Total: ", Math.round(total * 100), "% ", isValid ? 'âœ“' : '(must be 100%)'] }) })] })] }), _jsxs("div", { className: "pt-4 border-t border-slate-100", children: [_jsx(ToggleSwitch, { label: "Enable Glide Path", enabled: glidePathEnabled, onChange: setGlidePathEnabled, helperText: "Shift allocation over time" }), glidePathEnabled && (_jsx("div", { className: "mt-4", children: _jsx(GlidePathEditor, {}) }))] })] }));
};
